# Size of Investment

## China Foreign Investment by Region
```{r byregion, warning=FALSE, message=FALSE}
library(knitr)
library(RColorBrewer)
library(ggplot2)
library(tidyverse)
library(tidyr)
library(dplyr)
library(plotly)
investment <- read_csv("./data/investment.csv")
investment <- investment %>%
  filter(Year >=2005 && Year <= 2019)
data2 <- investment %>%
  group_by(Region) %>%
  summarise(counts = n()) %>%
  arrange(desc(Region)) %>%
  mutate(prop = round(counts*100/sum(counts), 1),
         lab.ypos = cumsum(prop) - 0.5*prop)

##plot
f2 <- ggplot(data2, aes(x = "", y = prop, fill = Region)) +
  geom_bar(width = 1, stat = "identity", color = "white") +
  geom_text(aes(y = lab.ypos, label = prop), color = "white")+
  coord_polar("y", start = 0)+
  ggpubr::fill_palette("jco")+
  ggtitle("China Foreign Investment by Region")+
  theme_void()
f2
```

The graph compares China's investment to foreign countries by different target regions in terms of project numbers, between 2005 and 2019. We used the percentage to present the number of projects. The top three target regions or countries are Europe, East Asia, and USA. However, if we combine the data from North America with USA, then North America should be the second most popular target of Chinese investment. MENA region has the fewest number of projects.


## Investment over World

We further plot the countries on the world map, and have a detailed insight on the world distribution:

```{r dataset,warning=FALSE, message=FALSE}
library(tidyverse)
investment <- read_csv("./data/investment.csv")
investment <- investment %>%
  filter(Year >=2005 && Year <= 2019)
map_world <- map_data("world")

##name adjustment
investment <- investment %>%
  mutate(country = recode(
    Country, `Russian Federation` = "Russia", 
    `Trinidad-Tobago` = "Trinidad", 
    `Antigua and Barbuda` = "Antigua",
    `Sao Tome` = "Sao Tome and Principe", 
    `UAE` =  "United Arab Emirates"
  ))
fdi_inv <- investment%>%
  group_by(country) %>%
  summarize(project_num = n())
fdi_inv <- left_join(map_world, fdi_inv, by = c("region" = "country"))

##plot the data
ggplot(fdi_inv, aes(x = long, y = lat, group = group)) +
  theme(legend.position = c(0.08,0.28))+
  geom_polygon(aes(fill = project_num))+
  scale_fill_gradientn(
    colours = c( "#2A8A8C","#404E88","#461863"), 
    values = scales::rescale(c(10,50,100)), 
    labels = scales::comma,
    name='Project Number'
  ) +
  guides(fill = guide_legend(reverse = T,keywidth = 1.5)) +
  labs(# legend name
    #fill = "num of projects", 
    title = "Number of Chinese FDI projects", 
    subtitle = "2005 to 2019", 
    x = NULL,
    y = NULL
  )
```

During 2005 to 2019, we can find that Chinese outward Foreign Direct Investment mainly focuses in USA and Australia,following by Canada, Russia, Brazil, Germany, and India. 


## China Investment by Year <br/>
Red-Investment, Steelblue-Construction.
```{r,warning=FALSE, message=FALSE}
mydata3 = read.csv("./data/combine.csv")  #read csv file 
#dim(mydata3)

mydata3i <- filter(mydata3, mydata3$Type == "Investment")
data3i <- mydata3i %>%
  group_by(Year) %>%
  summarise(counts = n()) 
data3i$Year <- as.numeric(as.character(data3i$Year))

mydata3c <- filter(mydata3, mydata3$Type == "Construction")
data3c <- mydata3c %>%
  group_by(Year) %>%
  summarise(counts = n()) 
data3c$Year <- as.numeric(as.character(data3c$Year))

```
```{r,warning=FALSE, message=FALSE}
xx <- ggplot() +
  geom_line(data3i, mapping =aes(x = Year, y = counts), color = "darkred") +
  geom_line(data3c, mapping =aes(x = Year, y = counts), color = "steelblue", linetype="twodash") +
  ggtitle("Figure 3: The 14-Year Trend of China Investment and Construction") +
    ylab("Number of projects") +
  scale_x_continuous(breaks=c(2005:2019), labels=c(2005:2019)) +
  # #scale_color_discrete(name = "FDI Type", labels = c("Investment", "Construction"))+ 
  # scale_color_manual(values = c(
  #   'Investment' = 'darkred',
  #   'Construction' = 'steelblue'))
  annotate("text", x = 2009, y = 37, label = "Investment") +
  annotate("text", x = 2007, y = 75, label = "Construction")
```
```{r,warning=FALSE, message=FALSE}
library(plotly)
ggplotly(xx)
```

The figure compares numbers of total Chinese foreign investments and construction projects  from 2005 to 2019. We find that the number of Chinese foreign investment has increased year-on-year before 2016 except for 2013. For construction projects, the number of projects has increased year-on-year before 2016 except for 2012. 

The number of investment and construction projects have both peaked in 2016, which are 235 and 206 respectively. It has later experienced a continuous drop in 2017 and 2018. The big decrease in 2019 may due to the fact that the data in 2019 was not fully collected. 

